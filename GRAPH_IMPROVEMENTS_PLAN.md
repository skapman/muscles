# üéØ –ü–ª–∞–Ω –£–ª—É—á—à–µ–Ω–∏–π –ì—Ä–∞—Ñ–∞

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### ‚úÖ –ß—Ç–æ –î–µ–ª–∞–µ–º:
1. **–¶–≤–µ—Ç–∞ –∏–∑ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ø–∞–ª–∏—Ç—Ä—ã** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
2. **–¢–µ–∫—Å—Ç –ø–æ–¥ —É–∑–ª–∞–º–∏** —Å —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏ –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
3. **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ä–∞–∑–º–µ—Ä—ã —É–∑–ª–æ–≤** –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–≤—è–∑–µ–π
4. **–°–ª–∞–π–¥–µ—Ä "–ü–æ—Ä–æ–≥"** –≤–º–µ—Å—Ç–æ —Å–ª–∞–π–¥–µ—Ä–∞ –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏
5. **–ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ —Å–≤—è–∑–∏** - —Ç–æ–Ω–∫–∏–µ –ª–∏–Ω–∏–∏ —Å opacity
6. **Hover —ç—Ñ—Ñ–µ–∫—Ç** - —É–≤–µ–ª–∏—á–µ–Ω–∏–µ + –ø–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö
7. **–ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ –Ω–µ—Å–≤—è–∑–∞–Ω–Ω—ã—Ö** —É–∑–ª–æ–≤ (opacity 0.3)
8. **–ü–ª–∞–≤–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏** - smooth transitions

### ‚ùå –ß—Ç–æ –ù–ï –î–µ–ª–∞–µ–º:
- ‚ùå –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ (—É–∂–µ –µ—Å—Ç—å)
- ‚ùå Tooltip —Ä—è–¥–æ–º —Å —É–∑–ª–æ–º
- ‚ùå –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª–µ–≥–µ–Ω–¥—ã
- ‚ùå –ü–æ–∏—Å–∫ —É–∑–ª–æ–≤

### ‚è≥ –û—Ç–¥–µ–ª—å–Ω–æ –ü–æ—Ç–æ–º:
- üîÑ Drag & drop —É–∑–ª–æ–≤ (—Å–ª–æ–∂–Ω–∞—è —Ñ–∏—á–∞)

---

## üé® –¶–≤–µ—Ç–æ–≤–∞—è –°—Ö–µ–º–∞

### –ú–∞–ø–ø–∏–Ω–≥ –¢–∏–ø–æ–≤ ‚Üí –¶–≤–µ—Ç–∞:
```javascript
const graphColors = {
  goals: 'var(--layer-respiratory)',      // #4caf50 (–∑–µ–ª–µ–Ω—ã–π)
  exercises: 'var(--layer-muscles)',      // #00d4ff (–≥–æ–ª—É–±–æ–π)
  muscles: 'var(--layer-pain)',           // #ff5252 (–∫—Ä–∞—Å–Ω—ã–π)
  pain: 'var(--layer-cardiovascular)'     // #f44336 (—Ç–µ–º–Ω–æ-–∫—Ä–∞—Å–Ω—ã–π)
};
```

### –ü–æ—á–µ–º—É –¢–∞–∫–æ–π –ú–∞–ø–ø–∏–Ω–≥:
- **Goals** ‚Üí –ó–µ–ª–µ–Ω—ã–π (—Ä–æ—Å—Ç, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ)
- **Exercises** ‚Üí –ì–æ–ª—É–±–æ–π (–¥–µ–π—Å—Ç–≤–∏–µ, –¥–≤–∏–∂–µ–Ω–∏–µ)
- **Muscles** ‚Üí –ö—Ä–∞—Å–Ω—ã–π (–∞–Ω–∞—Ç–æ–º–∏—è, —Ç–µ–ª–æ)
- **Pain** ‚Üí –¢–µ–º–Ω–æ-–∫—Ä–∞—Å–Ω—ã–π (–ø—Ä–æ–±–ª–µ–º–∞, –≤–Ω–∏–º–∞–Ω–∏–µ)

---

## üìê –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –®–∞–≥–∞–º

### –®–∞–≥ 1: –¶–≤–µ—Ç–∞ –∏–∑ CSS –ü–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
**–§–∞–π–ª:** `js/ui/RelationshipGraph.js`

```javascript
getNodeColor(type) {
  const colors = {
    goals: '#4caf50',      // var(--layer-respiratory)
    exercises: '#00d4ff',  // var(--layer-muscles)
    muscles: '#ff5252',    // var(--layer-pain)
    pain: '#f44336'        // var(--layer-cardiovascular)
  };
  return colors[type] || '#999';
}
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ —Ü–≤–µ—Ç–∞ –Ω–∞ –Ω–æ–≤—ã–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å hex –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

---

### –®–∞–≥ 2: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –†–∞–∑–º–µ—Ä –£–∑–ª–æ–≤
**–§–∞–π–ª:** `js/ui/RelationshipGraph.js`

**–î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥:**
```javascript
getNodeRadius(node) {
  // –ü–æ–¥—Å—á–µ—Ç —Å–≤—è–∑–µ–π
  const connections = this.graphData.edges.filter(edge =>
    (edge.source === node || edge.source?.id === node.id) ||
    (edge.target === node || edge.target?.id === node.id)
  ).length;

  // –§–æ—Ä–º—É–ª–∞ —Ä–∞–∑–º–µ—Ä–∞
  const baseSize = 15;
  const connectionBonus = connections * 3;
  const maxSize = 50;

  return Math.min(baseSize + connectionBonus, maxSize);
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ render():**
```javascript
// –í–º–µ—Å—Ç–æ:
const radius = 20;

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
const radius = this.getNodeRadius(node);
```

---

### –®–∞–≥ 3: –£–ª—É—á—à–µ–Ω–Ω—ã–π –¢–µ–∫—Å—Ç –ø–æ–¥ –£–∑–ª–∞–º–∏
**–§–∞–π–ª:** `js/ui/RelationshipGraph.js` ‚Üí `render()`

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```javascript
ctx.fillStyle = '#333';
ctx.font = '12px Inter, sans-serif';
ctx.textAlign = 'center';
ctx.fillText(label, node.x, node.y + radius + 15);
```

**–ù–æ–≤—ã–π –∫–æ–¥:**
```javascript
// –¢–µ–∫—Å—Ç —Å —Ç–µ–Ω—å—é –¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
ctx.fillStyle = '#ffffff';
ctx.shadowColor = 'rgba(0, 0, 0, 0.8)';
ctx.shadowBlur = 6;
ctx.shadowOffsetX = 0;
ctx.shadowOffsetY = 2;
ctx.font = 'bold 12px Inter, sans-serif';
ctx.textAlign = 'center';
ctx.fillText(label, node.x, node.y + radius + 18);

// –°–±—Ä–æ—Å —Ç–µ–Ω–∏
ctx.shadowBlur = 0;
ctx.shadowOffsetY = 0;
```

---

### –®–∞–≥ 4: –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ –°–≤—è–∑–∏
**–§–∞–π–ª:** `js/ui/RelationshipGraph.js` ‚Üí `render()`

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```javascript
ctx.strokeStyle = '#999';
ctx.lineWidth = 1;
```

**–ù–æ–≤—ã–π –∫–æ–¥:**
```javascript
ctx.strokeStyle = 'rgba(255, 255, 255, 0.15)';
ctx.lineWidth = 1;
```

---

### –®–∞–≥ 5: –°–ª–∞–π–¥–µ—Ä "–ü–æ—Ä–æ–≥" (Threshold)
**–§–∞–π–ª:** `js/ui/RelationshipGraph.js`

#### 5.1 –ó–∞–º–µ–Ω–∏—Ç—å createDepthSlider()
```javascript
createThresholdSlider() {
  const container = document.createElement('div');
  container.className = 'threshold-slider-container';

  const label = document.createElement('label');
  label.textContent = '–ü–æ—Ä–æ–≥ —Å–≤—è–∑–µ–π: ';
  label.className = 'threshold-label';

  const slider = document.createElement('input');
  slider.type = 'range';
  slider.min = '0';
  slider.max = '10';
  slider.value = '0';
  slider.className = 'threshold-slider';
  slider.id = 'threshold-slider';

  const valueDisplay = document.createElement('span');
  valueDisplay.className = 'threshold-value';
  valueDisplay.id = 'threshold-value';
  valueDisplay.textContent = '0+ —Å–≤—è–∑–µ–π';

  // Throttled update
  let updateTimeout;
  slider.addEventListener('input', (e) => {
    const threshold = parseInt(e.target.value);
    valueDisplay.textContent = `${threshold}+ —Å–≤—è–∑–µ–π`;

    clearTimeout(updateTimeout);
    updateTimeout = setTimeout(() => {
      this.filterByThreshold(threshold);
    }, 300);
  });

  container.appendChild(label);
  container.appendChild(slider);
  container.appendChild(valueDisplay);

  return container;
}
```

#### 5.2 –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
```javascript
filterByThreshold(minConnections) {
  this.graphData.nodes.forEach(node => {
    const connections = this.graphData.edges.filter(edge =>
      (edge.source === node || edge.source?.id === node.id) ||
      (edge.target === node || edge.target?.id === node.id)
    ).length;

    node.visible = connections >= minConnections;
  });

  this.applyFilters();
}
```

#### 5.3 –û–±–Ω–æ–≤–∏—Ç—å createControls()
```javascript
createControls() {
  const controls = document.createElement('div');
  controls.className = 'graph-controls';

  // Threshold slider (–≤–º–µ—Å—Ç–æ depth slider)
  const sliderContainer = this.createThresholdSlider();
  controls.appendChild(sliderContainer);

  // Filter buttons
  const filterContainer = this.createFilterButtons();
  controls.appendChild(filterContainer);

  this.container.appendChild(controls);
}
```

---

### –®–∞–≥ 6: Hover –≠—Ñ—Ñ–µ–∫—Ç
**–§–∞–π–ª:** `js/ui/RelationshipGraph.js`

#### 6.1 –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ hover
```javascript
constructor() {
  // ... existing code
  this.hoveredNode = null;
  this.highlightedNodes = new Set();
}
```

#### 6.2 –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ mousemove
```javascript
setupTouchGestures() {
  // ... existing touch code

  // Mouse hover for desktop
  this.canvas.addEventListener('mousemove', (e) => {
    if (!this.isMobile) {
      const rect = this.canvas.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;

      const node = this.findNodeAtPosition(x, y);

      if (node !== this.hoveredNode) {
        this.hoveredNode = node;
        if (node) {
          this.highlightConnectedNodes(node);
        } else {
          this.clearHighlight();
        }
        this.render();
      }
    }
  });
}
```

#### 6.3 –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥—ã –ø–æ–¥—Å–≤–µ—Ç–∫–∏
```javascript
highlightConnectedNodes(selectedNode) {
  this.highlightedNodes.clear();
  this.highlightedNodes.add(selectedNode.id);

  this.graphData.edges.forEach(edge => {
    const sourceId = edge.source?.id || edge.source;
    const targetId = edge.target?.id || edge.target;

    if (sourceId === selectedNode.id) {
      this.highlightedNodes.add(targetId);
    }
    if (targetId === selectedNode.id) {
      this.highlightedNodes.add(sourceId);
    }
  });
}

clearHighlight() {
  this.highlightedNodes.clear();
  this.hoveredNode = null;
}
```

#### 6.4 –û–±–Ω–æ–≤–∏—Ç—å render() –¥–ª—è –ø–æ–¥—Å–≤–µ—Ç–∫–∏
```javascript
render() {
  // ... existing code

  // Draw nodes
  this.graphData.nodes.forEach(node => {
    if (!node.visible || !node.x || !node.y) return;

    const isHighlighted = this.highlightedNodes.has(node.id);
    const isHovered = this.hoveredNode === node;
    const isDimmed = this.hoveredNode && !isHighlighted;

    const color = this.getNodeColor(node.type);
    let radius = this.getNodeRadius(node);

    // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø—Ä–∏ hover
    if (isHovered) {
      radius *= 1.2;
    }

    // –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ –Ω–µ—Å–≤—è–∑–∞–Ω–Ω—ã—Ö
    const opacity = isDimmed ? 0.3 : 1.0;

    // Node circle
    ctx.globalAlpha = opacity;
    ctx.beginPath();
    ctx.arc(node.x, node.y, radius, 0, 2 * Math.PI);
    ctx.fillStyle = color;
    ctx.fill();

    // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –≥—Ä–∞–Ω–∏—Ü—ã –¥–ª—è hovered/highlighted
    if (isHighlighted) {
      ctx.strokeStyle = '#ffffff';
      ctx.lineWidth = isHovered ? 4 : 2;
      ctx.stroke();
    } else {
      ctx.strokeStyle = '#fff';
      ctx.lineWidth = 2;
      ctx.stroke();
    }

    ctx.globalAlpha = 1.0;

    // ... text rendering
  });
}
```

---

### –®–∞–≥ 7: –ü–ª–∞–≤–Ω—ã–µ –ê–Ω–∏–º–∞—Ü–∏–∏
**–§–∞–π–ª:** `styles/components/graph.css`

```css
/* Smooth transitions –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
.graph-canvas {
  transition: all 0.3s ease;
}

.filter-btn {
  transition: all 0.2s ease;
}

.threshold-slider::-webkit-slider-thumb {
  transition: transform 0.2s ease;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

.graph-canvas-container {
  animation: fadeIn 0.3s ease;
}
```

---

## üìä –ü–æ—Ä—è–¥–æ–∫ –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –§–∞–∑–∞ 1: –í–∏–∑—É–∞–ª—å–Ω—ã–µ –£–ª—É—á—à–µ–Ω–∏—è (30 –º–∏–Ω)
1. ‚úÖ –¶–≤–µ—Ç–∞ –∏–∑ CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
2. ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä —É–∑–ª–æ–≤
3. ‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç —Å —Ç–µ–Ω—å—é
4. ‚úÖ –ü–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ —Å–≤—è–∑–∏

### –§–∞–∑–∞ 2: –°–ª–∞–π–¥–µ—Ä –ü–æ—Ä–æ–≥–∞ (20 –º–∏–Ω)
5. ‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å depth slider –Ω–∞ threshold slider
6. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ —Å–≤—è–∑—è–º
7. ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å CSS —Å—Ç–∏–ª–∏

### –§–∞–∑–∞ 3: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (30 –º–∏–Ω)
8. ‚úÖ Hover —ç—Ñ—Ñ–µ–∫—Ç
9. ‚úÖ –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —É–∑–ª–æ–≤
10. ‚úÖ –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ –Ω–µ—Å–≤—è–∑–∞–Ω–Ω—ã—Ö
11. ‚úÖ –ü–ª–∞–≤–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏

### –§–∞–∑–∞ 4: Drag & Drop (–û—Ç–¥–µ–ª—å–Ω–æ, 1-2 —á–∞—Å–∞)
12. ‚è≥ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è —É–∑–ª–æ–≤
13. ‚è≥ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –≤ D3 simulation
14. ‚è≥ Touch support –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö

---

## üéØ –û–∂–∏–¥–∞–µ–º—ã–π –†–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≥—Ä–∞—Ñ –±—É–¥–µ—Ç:
- üé® –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Ü–≤–µ—Ç–æ–≤—É—é –ø–∞–ª–∏—Ç—Ä—É
- üìä –†–∞–∑–º–µ—Ä —É–∑–ª–æ–≤ –æ—Ç—Ä–∞–∂–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤—è–∑–µ–π
- üîç –¢–µ–∫—Å—Ç —á–∏—Ç–∞–µ–º—ã–π —Å —Ç–µ–Ω—å—é
- üå´Ô∏è –°–≤—è–∑–∏ –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ –∏ –Ω–µ–Ω–∞–≤—è–∑—á–∏–≤—ã–µ
- üéöÔ∏è –°–ª–∞–π–¥–µ—Ä –ø–æ—Ä–æ–≥–∞ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- üñ±Ô∏è Hover –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ —É–∑–ª—ã
- ‚ú® –ü–ª–∞–≤–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üìù –ò–∑–º–µ–Ω—è–µ–º—ã–µ –§–∞–π–ª—ã

1. **js/ui/RelationshipGraph.js** - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
2. **styles/components/graph.css** - —Å—Ç–∏–ª–∏
3. **graph-demo.html** - –≤–æ–∑–º–æ–∂–Ω–æ –Ω–µ–±–æ–ª—å—à–∏–µ –ø—Ä–∞–≤–∫–∏

---

**–ì–æ—Ç–æ–≤ –Ω–∞—á–∏–Ω–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é! –ù–∞—á–Ω–µ–º —Å –§–∞–∑—ã 1?**
